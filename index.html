<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Peltra • Market Prices</title>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Page CSS -->
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- Header / Hero -->
  <header class="site-header">
    <div class="hero">
      <img src="assets/Logo.png" alt="Peltra" class="hero-logo" />
      <h1 class="hero-title">Market Prices</h1>
      <p class="hero-subtitle">Live pellet & briquette intelligence by location with quick trends.</p>
    </div>
  </header>

  <!-- Global Nav -->
  <nav>
    <div class="nav-links">
      <a href="index.html">Home</a>
      <a href="market.html" aria-current="page">Market Prices</a>
      <a href="news.html">News</a>
      <a href="contact.html">Contact</a>
    </div>
  </nav>

  <main>
    <!-- Controls -->
    <section class="section controls">
      <div class="row">
        <label class="control">
          <span class="control-label">Location</span>
          <select id="locationSelect" class="select"></select>
        </label>

        <div class="control-pair">
          <label class="control">
            <span class="control-label">Pellet type</span>
            <select id="materialSelect" class="select"></select>
          </label>
          <label class="control">
            <span class="control-label">Briquette type</span>
            <select id="briquetteSelect" class="select"></select>
          </label>
        </div>
      </div>
    </section>

    <!-- Summary Cards -->
    <section class="section price-grid">
      <div class="price-card">
        <div class="price-label">Pellet Price</div>
        <div class="price-value">
          ₹<span id="pelletPrice">--</span><span class="unit">/ton</span>
        </div>
        <div id="pelletDelta" class="delta chip chip-muted">—</div>
        <div id="pelletSpecs" class="specs"></div>
        <div class="last-updated">Last updated: <span id="pelletTimestamp">—</span></div>
      </div>

      <div class="price-card">
        <div class="price-label">Briquette Price</div>
        <div class="price-value">
          ₹<span id="briquettePrice">--</span><span class="unit">/ton</span>
        </div>
        <div id="briquetteDelta" class="delta chip chip-muted">—</div>
        <div id="briquetteSpecs" class="specs"></div>
        <div class="last-updated">Last updated: <span id="briquetteTimestamp">—</span></div>
      </div>
    </section>

    <!-- Charts -->
    <section class="section graph-grid">
      <article class="chart-card">
        <h3 id="chartTitle">Pellet Price Trend</h3>
        <canvas id="priceChart"></canvas>
      </article>
      <article class="chart-card">
        <h3 id="briquetteChartTitle">Briquette Price Trend</h3>
        <canvas id="briquetteChart"></canvas>
      </article>
    </section>

    <!-- Pellet table (with Show all) -->
    <section class="section">
      <div class="table-card">
        <div class="table-head">
          <h3>Pellet Prices (₹/ton)</h3>
          <button id="pelletToggleBtn" class="link-btn">Show all</button>
        </div>
        <table id="materialTable"></table>
      </div>
    </section>

    <!-- Briquette table (with Show all) -->
    <section class="section">
      <div class="table-card">
        <div class="table-head">
          <h3>Briquette Prices (₹/ton)</h3>
          <button id="briquetteToggleBtn" class="link-btn">Show all</button>
        </div>
        <table id="briquetteTable"></table>
      </div>
    </section>

    <!-- Freight Calculator -->
    <section class="section calc-card" id="freightCalc">
      <h3>Freight Calculator</h3>

      <div class="calc-grid">
        <label>
          <span>Distance (km)</span>
          <input id="fc-distance" type="number" min="1" placeholder="e.g., 320" required>
        </label>

        <label>
          <span>Quantity (tons)</span>
          <input id="fc-qty" type="number" min="1" placeholder="e.g., 20" required>
        </label>

        <label>
          <span>Truck Type</span>
          <select id="fc-truck">
            <option value="20">20T</option>
            <option value="24">24T</option>
            <option value="28">28T</option>
          </select>
        </label>

        <label>
          <span>Freight Base (₹/km)</span>
          <input id="fc-base" type="number" min="0" step="0.01" placeholder="e.g., 35" required>
        </label>
      </div>

      <div class="calc-actions">
        <button id="fc-calc" type="button" class="btn primary">Calculate</button>
        <button id="fc-reset" type="button" class="btn ghost">Reset</button>
      </div>

      <div id="fc-results" class="calc-results" hidden>
        <p><strong>Total Freight:</strong> <span id="fc-total">₹0</span></p>
        <p><strong>Freight per ton:</strong> <span id="fc-perton">₹0/ton</span></p>
      </div>
      <p class="note">* Estimates only. Actuals vary by lane, loading, wait time & diesel price.</p>
    </section>

    <!-- Submit Your Own Price (Netlify Forms) -->
    <section class="section">
      <div class="card" id="submit-price">
        <h3>Submit Your Own Price</h3>
        <p class="muted">Keep the market sharp. Submissions are reviewed before inclusion.</p>

        <form name="price-submissions" method="POST" data-netlify="true" netlify-honeypot="bot-field">
          <input type="hidden" name="form-name" value="price-submissions">
          <p style="display:none;">
            <label>Don’t fill this out: <input name="bot-field" /></label>
          </p>

          <div class="grid-2">
            <div class="field">
              <label for="spMaterial">Material</label>
              <input id="spMaterial" name="material" type="text" placeholder="e.g., Pellet – Rice Husk" required />
            </div>

            <div class="field">
              <label for="spPrice">Price (₹/ton)</label>
              <input id="spPrice" name="price" type="number" inputmode="numeric" placeholder="e.g., 7700" required />
            </div>

            <div class="field">
              <label for="spQty">Quantity (tons)</label>
              <input id="spQty" name="quantity" type="number" inputmode="numeric" placeholder="e.g., 40" required />
            </div>

            <div class="field">
              <label for="spCity">City / Cluster</label>
              <input id="spCity" name="city" type="text" placeholder="e.g., Yamunanagar" required />
            </div>
          </div>

          <div class="field" style="margin-top:8px;">
            <label for="spNotes">Notes (optional)</label>
            <input id="spNotes" name="notes" type="text" placeholder="e.g., ex‑factory, incl. loading" />
          </div>

          <div class="actions">
            <button type="submit" class="btn primary">Submit Price</button>
          </div>
        </form>

        <h4 style="margin-top:16px;">Community Prices (recent)</h4>
        <div id="submitFeed" class="feed"></div>
      </div>
    </section>
  </main>

  <footer>
    <p>© 2025 Peltra. Built for the biomass industry.</p>
  </footer>

  <!-- Page JS -->
  <script src="script.js"></script>
</body>
</html>